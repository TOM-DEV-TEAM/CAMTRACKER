{% extends 'layouts/base.html' %}
{% load static %}

{% block breadcrumbs %}{% endblock breadcrumbs %}
{% block content %}
<script>
    function filterTable() {
    // Récupérer la valeur du champ de recherche
    var input = document.getElementById("search-input");
    var filter = input.value.toUpperCase();
    var table = document.getElementById("mouvements-table");
    var tr = table.getElementsByTagName("tr");

    // Parcourir toutes les lignes du tableau
    for (var i = 1; i < tr.length; i++) { // Commence à 1 pour ignorer l'en-tête
        var tdArray = tr[i].getElementsByTagName("td");
        var rowText = "";

        // Parcourir toutes les colonnes de chaque ligne
        for (var j = 0; j < tdArray.length; j++) {
            rowText += tdArray[j].textContent || tdArray[j].innerText;
        }

        // Vérifier si le texte de la ligne correspond à la recherche
        if (rowText.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
        } else {
            tr[i].style.display = "none";
        }
    }
}

</script>

<input type="text" id="search-input" style="margin-left: 20px; width:20%" placeholder="Rechercher..."
       onkeyup="filterTable()" class="form-control" style="margin-bottom: 10px;">

<ul class="nav nav-tabs" style="margin-left: 20px">
    <li class="nav-item">
        <a class="nav-link" href="/entreedecalog_view/{{ util.id_user }}">ICD</a>
    </li>
    <li class="nav-item">
        <a class="nav-link " href="/entreedecalog_view1/{{ util.id_user }}" tabindex="-1">SACHERIE</a>
    </li>
    <li class="nav-item">
        <a class="nav-link active" href="/entreedecalog_view2/{{ util.id_user }}" tabindex="-1">ZUD</a>
    </li>
    <li class="nav-item ">
        <a class="nav-link" href="/entreedecalog_particulier/{{ util.id_user }}" tabindex="-1">PARTICULIER</a>
    </li>
</ul><br>
<!-- [ rating list ] end-->
<div class="col-xl-8 col-md-12 m-b-30">
    <!--<p class="label theme-bg text-white f-12"  class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModalajout">Ajouter</p>-->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <p class="label theme-bg text-white f-12" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal"
       style="font-size: large">Ajouter</p>

    <h3 class="modal-title" id="editModalLabel">Entrée Camions ZUD </h3>

    <div class="container  ">
        <div class="table-responsive">
            <table id="mouvements-table" class="table table-hover" style="margin-top: 15px;">
                <thead class="thead-light">
                <tr>
                    <th scope="col" class="d-md-table-cell">#</th>
                    <th scope="col" class="d-md-table-cell">Zone Entrée</th>
                    <th scope="col" class="d-md-table-cell">Date Entrée</th>
                    <th scope="col" class="d-md-table-cell">Camion</th>
                    <th scope="col" class="d-md-table-cell">Type</th>
                    <th scope="col" class="d-md-table-cell">Transporteur</th>
                    <th scope="col" class="d-md-table-cell">Conteneur 1</th>
                    <th scope="col" class="d-md-table-cell">Type</th>
                    <th scope="col" class="d-md-table-cell">Conteneur 2</th>
                    <th scope="col" class="d-md-table-cell">Type</th>
                    <th scope="col" class="d-md-table-cell">Conteneur 3</th>
                    <th scope="col" class="d-md-table-cell">Type</th>
                    <th scope="col" class="d-md-table-cell">Conteneur 4</th>
                    <th scope="col" class="d-md-table-cell">Type</th>
                    <th scope="col" class="d-md-table-cell">Conteneur 5</th>
                    <th scope="col" class="d-md-table-cell">Type</th>
                    <th scope="col" class="d-md-table-cell">Destination</th>
                    <th scope="col" class="d-md-table-cell">Chauffeur</th>
                    <th scope="col" class="d-md-table-cell">Permis</th>
                    <th scope="col" class="d-md-table-cell">Client</th>
                    <th scope="col" class="d-md-table-cell">Téléphone</th>
                    <th scope="col" class="d-md-table-cell">Transitaire</th>
                    <th scope="col" class="d-md-table-cell">Téléphone</th>
                    <th scope="col" class="d-md-table-cell">Representant</th>
                    <th scope="col" class="d-md-table-cell">Téléphone</th>
                    <th scope="col" class="d-md-table-cell">Statut</th>
                </tr>
                </thead>
                <tbody>
                {% if mouvements %}
                {% for mouvement in mouvements %}
                <tr>
                    <td>{% if mouvement.camion.type == 'VRAC' %}
                        <a class="label theme-bg text-white f-12 btn btn-info btn-lg"
                           data-id_mvt="{{ mouvement.id_mvt }}"
                           data-typecam="{{ mouvement.camion.type }}"
                           data-utilisateur-id="{{ util.id_user }}"
                           data-numcont1="{{ mouvement.numconteneur1 }}"
                           data-typecont1="{{ mouvement.typeconteneur1 }}"
                           data-numcont2="{{ mouvement.numconteneur2 }}"
                           data-typecont2="{{ mouvement.typeconteneur2 }}"
                           data-numcont3="{{ mouvement.numconteneur3 }}"
                           data-typecont3="{{ mouvement.typeconteneur3 }}"
                           data-numcont4="{{ mouvement.numconteneur4 }}"
                           data-typecont4="{{ mouvement.typeconteneur4 }}"
                           data-numcont5="{{ mouvement.numconteneur5 }}"
                           data-typecont5="{{ mouvement.typeconteneur5 }}"
                           data-client="{{ mouvement.client.id_client }}"
                           data-transitaire="{{ mouvement.transitaire.id_transit }}"
                           data-representant="{{ mouvement.representant.id_transit }}"
                           href="#!"
                           data-toggle="modal"
                           data-target="#myModal1">
                            LIAISON
                        </a>
                        {% elif mouvement.camion.type == 'SEMI-REMORQUE' %}
                        <a class="label theme-bg text-white f-12 btn btn-info btn-lg"
                           data-id_mvt="{{ mouvement.id_mvt }}" data-typecam="{{ mouvement.camion.type }}"
                           data-utilisateur-id="{{ util.id_user }}"
                           data-numcont1="{{ mouvement.numconteneur1 }}"
                           data-typecont1="{{ mouvement.typeconteneur1 }}"
                           data-numcont2="{{ mouvement.numconteneur2 }}"
                           data-typecont2="{{ mouvement.typeconteneur2 }}"
                           data-numcont3="{{ mouvement.numconteneur3 }}"
                           data-typecont3="{{ mouvement.typeconteneur3 }}"
                           data-client="{{ mouvement.client.id_client }}"
                           data-transitaire="{{ mouvement.transitaire.id_transit }}"
                           data-representant="{{ mouvement.representant.id_transit }}"
                           href="#!"
                           data-toggle="modal"
                           data-target="#myModal2">
                            LIAISON
                        </a>

                        {% endif %}
                    </td>
                    </td>
                    <td>{{ mouvement.zone_entree }}</td>
                    <td>{{ mouvement.date_entree }}</td>
                    <td>{{ mouvement.camion.immatriculation }}</td>
                    <td>{{ mouvement.camion.type }}</td>
                    <td>{{ mouvement.camion.transporteur }}</td>
                    <td>{{ mouvement.real_numconteneur1|default:"Non Assigné" }}</td>
                    <td>{{ mouvement.typeconteneur1|default:"Non Assigné" }}</td>
                    <td>{{ mouvement.real_numconteneur2|default:"Non Assigné" }}</td>
                    <td>{{ mouvement.typeconteneur2|default:"Non Assigné" }}</td>
                    <td>{{ mouvement.real_numconteneur3|default:"Non Assigné" }}</td>
                    <td>{{ mouvement.typeconteneur3|default:"Non Assigné" }}</td>
                    <td>{{ mouvement.real_numconteneur4|default:"Non Assigné" }}</td>
                    <td>{{ mouvement.typeconteneur4|default:"Non Assigné" }}</td>
                    <td>{{ mouvement.real_numconteneur5|default:"Non Assigné" }}</td>
                    <td>{{ mouvement.typeconteneur5|default:"Non Assigné" }}</td>
                    <td>{{ mouvement.destination }}</td>
                    <td>{{ mouvement.chauffeur.fullname }}</td>
                    <td>{{ mouvement.chauffeur.permis }}</td>
                    <td>{{ mouvement.client.fullname }}</td>
                    <td>{{ mouvement.client.telephone }}</td>
                    <td>{{ mouvement.transitaire.fullname }}</td>
                    <td>{{ mouvement.transitaire.telephone }}</td>
                    <td>{{ mouvement.representant.fullname }}</td>
                    <td>{{ mouvement.representant.telephone }}</td>
                    <td>
                        {% if mouvement.statut_entree == 0 %}
                        Vide
                        {% elif mouvement.statut_entree == 1 %}
                        Partielle
                        {% elif mouvement.statut_entree == 2 %}
                        Plein
                        {% else %}
                        Non Assigné
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
                {% else %}
                <tr>
                    <td colspan="7">Aucun mouvement disponible</td>
                </tr>
                {% endif %}
                </tbody>
            </table>

        </div>
    </div>

</div>

<div class="container mt-5">
    <!--<h2>Modal Example</h2>
     Trigger the modal with a button
    <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Open Modal</button>

   Modal -->
    <div class="modal fade" id="myModal" style="overflow-y: auto;" role="dialog" class="modal fade" tabindex="-1"
         role="dialog"
         aria-labelledby="editModalLabel" aria-hidden="true">

        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editModalLabel">Entrée Camion: ZUD</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="POST" action="{% url 'ajoutmouvement0' util.id_user %}"
                          enctype="multipart/form-data">

                        <div class="text-center mb-4">
                            <!--<p style="color: #000; font-size: 25px;">ENTREE DK LOG</p>--->
                        </div>
                        {% csrf_token %}
                        {{ form.non_field_errors }}

                        <div class="form-group">
                            <label for="bd" class="form-label">Zone</label><br>
                            <div class="form-check form-check-inline">
                                <input value="Sud" type="radio" name="zone" checked required class="form-check-input">
                                <label for="bdOui" class="form-check-label">Sud</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input value="Nord" type="radio" name="zone" required class="form-check-input">
                                <label for="bdNon" class="form-check-label">Nord</label>
                            </div>
                        </div>

                        <input type="hidden" name="destination" value="zud">
                        <input type="hidden" name="entite" value="zud">
                        <div class="form-row">
                            <div class="col-md-3 mb-3">
                                <label for="camion-select">Camion</label>
                                <select name="camion" class="form-control form-control-lg" id="camion-select"
                                        required>
                                    <option value="" data-type="" data-transporteur=""></option>
                                </select>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label for="type">Type</label>
                                <input type="text" name="type" id="type" class="form-control form-control-lg"
                                       placeholder="" readonly/>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label for="transporteur">Transporteur</label>
                                <input type="text" name="transporteur" id="transporteur"
                                       class="form-control form-control-lg" placeholder="" readonly/>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label>&nbsp;</label>
                                <!-- Utilisez un label vide pour aligner verticalement le bouton -->
                                <button type="button" class="btn btn-info btn-block" data-toggle="modal"
                                        data-target="#myModalajoutcamion">
                                    <i class="fas fa-plus-circle"></i>
                                </button>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-md-4 mb-3">
                                <label for="client-select">Client</label>
                                <select name="client" class="form-control form-control-lg" id="client-select"
                                        required>
                                    <option value="" data-telephone=""></option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="telephone">Téléphone</label>
                                <input type="text" name="telephone" id="telephone"
                                       class="form-control form-control-lg" placeholder="" readonly/>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label>&nbsp;</label>
                                <!-- Utilisez un label vide pour aligner verticalement le bouton -->
                                <button type="button" class="btn btn-info btn-block" data-toggle="modal"
                                        data-target="#myModalajoutclient">
                                    <i class="fas fa-plus-circle"></i>
                                </button>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-md-4 mb-3">
                                <label for="chauffeur-select">Chauffeur</label>
                                <select name="chauffeur" class="form-control form-control-lg" id="chauffeur-select"
                                        required>
                                    <option value="" data-permis=""></option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="permis">Permis</label>
                                <input type="text" name="permis" id="permis" class="form-control form-control-lg"
                                       placeholder="" readonly/>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label>&nbsp;</label>
                                <!-- Utilisez un label vide pour aligner verticalement le bouton -->
                                <button type="button" class="btn btn-info btn-block" data-toggle="modal"
                                        data-target="#myModalajoutchauffeur">
                                    <i class="fas fa-plus-circle"></i>
                                </button>
                            </div>
                        </div>
                        <div class="row" id="conteneurs-div" style="display: none;">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="conteneur1">Conteneur 1</label>
                                    <input type="text" class="form-control form-control-lg" name="numconteneur1"
                                           id="numconteneur1" placeholder="Entrez le conteneur"/>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="typeconteneur1">Type</label>
                                    <select name="typeconteneur1" id="typeconteneur1"
                                            class="form-control form-control-lg">
                                        <option value="">Sélectionnez un type</option>
                                        <option value="20">20'</option>
                                        <option value="40">40'</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="row" id="conteneur2-div" style="display: none;">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="conteneur2">Conteneur 2</label>
                                    <input type="text" class="form-control form-control-lg" name="numconteneur2"
                                           id="numconteneur2" placeholder="Entrez le conteneur">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="typeconteneur2">Type</label>
                                    <select name="typeconteneur2" id="typeconteneur2"
                                            class="form-control form-control-lg">
                                        <option value="">Sélectionnez un type</option>
                                        <option value="20">20'</option>
                                        <option value="40">40'</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="row" id="conteneur3-div" style="display: none;">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="conteneur3">Conteneur 3</label>
                                    <input type="text" class="form-control form-control-lg" name="numconteneur3"
                                           id="numconteneur3" placeholder="Entrez le conteneur">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="typeconteneur3">Type</label>
                                    <select name="typeconteneur3" id="typeconteneur3"
                                            class="form-control form-control-lg">
                                        <option value="">Sélectionnez un type</option>
                                        <option value="20">20'</option>
                                        <option value="40">40'</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row" id="conteneur4-div" style="display: none;">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="conteneur4">Conteneur 4</label>
                                    <input type="text" class="form-control form-control-lg" name="numconteneur4"
                                           id="numconteneur4" placeholder="Entrez le conteneur">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="typeconteneur4">Type</label>
                                    <select name="typeconteneur4" id="typeconteneur4"
                                            class="form-control form-control-lg">
                                        <option value="">Sélectionnez un type</option>
                                        <option value="20">20'</option>
                                        <option value="40">40'</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row" id="conteneur5-div" style="display: none;">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="conteneur5">Conteneur 5</label>
                                    <input type="text" class="form-control form-control-lg" name="numconteneur5"
                                           id="numconteneur5" placeholder="Entrez le conteneur">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="typeconteneur5">Type</label>
                                    <select name="typeconteneur5" id="typeconteneur5"
                                            class="form-control form-control-lg">
                                        <option value="">Sélectionnez un type</option>
                                        <option value="20">20'</option>
                                        <option value="40">40'</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <!-------------------Ajouter Transitaire -------------------------->
                        <div class="form-row">
                            <div class="col-md-4 mb-3">
                                <label for="transitaire-select">Transitaire</label>
                                <select name="transitaire" class="form-control form-control-lg"
                                        id="transitaire-select" required>
                                    <option value="" data-permis=""></option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="permis">Telephone</label>
                                <input type="tel" name="telephone" id="telephonetransit"
                                       class="form-control form-control-lg" placeholder="" readonly/>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label>&nbsp;</label>
                                <!-- Utilisez un label vide pour aligner verticalement le bouton -->
                                <button type="button" class="btn btn-info btn-block" data-toggle="modal"
                                        data-target="#myModalajouttransitaire">
                                    <i class="fas fa-plus-circle"></i>
                                </button>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-md-4 mb-3">
                                <label for="transitairerep-select">Représentant</label>
                                <select name="representant" class="form-control form-control-lg"
                                        id="transitairerep-select" required>
                                    <option value="" data-permis=""></option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="permis">Telephone</label>
                                <input type="tel" name="telephone" id="telephonetransitrep"
                                       class="form-control form-control-lg" placeholder="" readonly/>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label>&nbsp;</label>
                                <!-- Utilisez un label vide pour aligner verticalement le bouton -->
                                <button type="button" class="btn btn-info btn-block" data-toggle="modal"
                                        data-target="#myModalajouttransitairerep">
                                    <i class="fas fa-plus-circle"></i>
                                </button>
                            </div>
                        </div>

                        <div class="form-row" id="inputsforangards1" style="display: none">
                            <div class="form-group col-md-4">
                                <label for="statut_entree">Bl1</label>
                                <input type="text" class="form-control" name="bl1" placeholder="BL1">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="bl2">Bl2</label>
                                <input type="text" class="form-control" name="bl2" placeholder="BL2">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="navire">Navire</label>
                                <input type="text" class="form-control" name="navire" placeholder="Navire">
                            </div>
                        </div>
                        <!-- Row for the last two inputs -->
                        <div class="form-row" id="inputsforangards2" style="display: none">
                            <div class="form-group col-md-6">
                                <label for="statut_entree">Tonnage</label>
                                <input type="number" min="0" class="form-control" name="tonnage"
                                       placeholder="Tonnage">
                            </div>
                            <div class="form-group col-md-6">
                                <label for="statut_entree">Nbr Colis</label>
                                <input type="number" min="0" class="form-control" name="nbrcolis"
                                       placeholder="Nbr Coli">
                            </div>
                        </div>

                        <div class="form-row mb-4">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="remorque">Remorque</label>
                                    <input id="remorque" type="text" name="remorque"
                                           class="form-control form-control-lg"
                                           placeholder="REMORQUE" required/>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="marchandise">Marchandise</label>
                                    <input type="text" name="marchandise" class="form-control form-control-lg"
                                           placeholder="MARCHANDISE" required/>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="datetime-input">Date Validité</label>
                                    <input type="datetime-local" name="date_validite" id="datetime-input"
                                           class="form-control form-control-lg"
                                           required/>
                                </div>
                            </div>
                        </div>
                        <input name="mission" type="hidden" value="DEPOTAGE" class="form-control form-control-lg"
                               id="mission-select"
                               required/>
                        <div class="modal-footer">
                            <input type="submit" class="btn btn-primary" value="Enregistrer">
                            <button type="button" class="btn btn-danger" data-dismiss="modal">Fermer</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- FORMULAIRE MYMODAL 1 -->
<div class="modal fade" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="editModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content" style="overflow-y: auto;">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Entrée Camion: ZUD</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form method="POST" action="{% url 'liaisonmouvement0' util.id_user %}" enctype="multipart/form-data">
                    {% csrf_token %}
                    {{ form.non_field_errors }}
                    <input type="hidden" id="id_mvt" name="id_mvt">
                    <input type="hidden" value="VRAC" name="typecam">
                    <input type="hidden" name="client" id="client-select1">
                    <input type="hidden" name="representant" id="representant-select1">
                    <input type="hidden" name="transitaire" id="transitaire-select1">
                    <div class="form-group">
                        <label for="bd" class="form-label">Zone</label><br>
                        <div class="form-check form-check-inline">
                            <input value="Sud" type="radio" name="zone" checked required class="form-check-input">
                            <label for="bdOui" class="form-check-label">Sud</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input value="Nord" type="radio" name="zone" required class="form-check-input">
                            <label for="bdNon" class="form-check-label">Nord</label>
                        </div>
                    </div>
                    <input type="hidden" name="destination" value="zud">
                    <input type="hidden" name="entite" value="zud">

                    <div class="form-row">
                        <div class="col-md-3 mb-3">
                            <label for="camion-select1">Camion</label>
                            <select name="camion" class="form-control form-control-lg" id="camion-select1" required>
                                <option value="" data-type1="" data-transporteur1=""></option>
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="type1">Type</label>
                            <input type="text" name="type" id="type1" class="form-control form-control-lg"
                                   readonly/>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="transporteur1">Transporteur</label>
                            <input type="text" name="transporteur" id="transporteur1"
                                   class="form-control form-control-lg" readonly/>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info btn-block" data-toggle="modal"
                                    data-target="#myModalajoutcamion">
                                <i class="fas fa-plus-circle"></i>
                            </button>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="col-md-4 mb-3">
                            <label for="chauffeur-select">Chauffeur</label>
                            <select name="chauffeur" class="form-control form-control-lg" id="chauffeur-select1"
                                    required>
                                <option value="" data-permis1=""></option>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="permis">Permis</label>
                            <input type="text" name="permis" id="permis1" class="form-control form-control-lg"
                                   readonly/>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info btn-block" data-toggle="modal"
                                    data-target="#myModalajoutchauffeur">
                                <i class="fas fa-plus-circle"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Section conteneurs -->
                    <div class="row" id="conteneurs-div" style="display: none;">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="conteneur1">Conteneur 1</label>
                                <input type="text" class="form-control form-control-lg" name="numconteneur1"
                                       id="numconteneur1" placeholder="Entrez le conteneur"/>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="typeconteneur1">Type</label>
                                <select name="typeconteneur1" id="typeconteneur1"
                                        class="form-control form-control-lg">
                                    <option value="">Sélectionnez un type</option>
                                    <option value="20">20'</option>
                                    <option value="40">40'</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="row" id="conteneur2-div" style="display: none;">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="conteneur2">Conteneur 2</label>
                                <input type="text" class="form-control form-control-lg" name="numconteneur2"
                                       id="numconteneur2" placeholder="Entrez le conteneur">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="typeconteneur2">Type</label>
                                <select name="typeconteneur2" id="typeconteneur2"
                                        class="form-control form-control-lg">
                                    <option value="">Sélectionnez un type</option>
                                    <option value="20">20'</option>
                                    <option value="40">40'</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-row mb-4">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="remorque">Remorque</label>
                                <input id="remorque" type="text" name="remorque"
                                       class="form-control form-control-lg" placeholder="REMORQUE" required/>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="datetime-input">Date Validité</label>
                                <input type="datetime-local" name="date_validite" id="datetime-input"
                                       class="form-control form-control-lg" required/>
                            </div>
                        </div>
                    </div>
                    <div class="form-group ">
                        <label>Conteneurs:</label>
                        <div class="checkbox-inline">
                            <label>
                                <input type="checkbox" name="numcont1" id="numcont1" value="">
                                <span id="labelcont1"></span>
                            </label>
                        </div>
                        <div class="checkbox-inline">
                            <label>
                                <input type="checkbox" name="numcont2" id="numcont2" value="">
                                <span id="labelcont2"></span>
                            </label>
                        </div>
                        <div class="checkbox-inline">
                            <label>
                                <input type="checkbox" name="numcont3" id="numcont3" value="">
                                <span id="labelcont3"></span>
                            </label>
                        </div>
                        <div class="checkbox-inline">
                            <label>
                                <input type="checkbox" name="numcont4" id="numcont4" value="">
                                <span id="labelcont4"></span>
                            </label>
                        </div>
                        <div class="checkbox-inline">
                            <label>
                                <input type="checkbox" name="numcont5" id="numcont5" value="">
                                <span id="labelcont5"></span>
                            </label>
                        </div>
                    </div>
                    <!-- Champs cachés pour stocker les types de conteneurs -->
                    <input type="hidden" id="typecont1" name="typecont1">
                    <input type="hidden" id="typecont2" name="typecont2">
                    <input type="hidden" id="typecont3" name="typecont3">
                    <input type="hidden" id="typecont4" name="typecont4">
                    <input type="hidden" id="typecont5" name="typecont5">
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                        <button type="submit" class="btn btn-primary" id="submitButton1">Sauvegarder</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- SCRIPT QUI RENVOIE LES DONNES AU MYMODAL 1 -->
<script>
    $(document).ready(function () {
        $('#myModal1').on('show.bs.modal', function (event) {
            var button = $(event.relatedTarget); // Bouton qui a déclenché le modal

            // Récupérer les valeurs des attributs `data-*`
            var id_mvt = button.data('id_mvt');
            var typecam = button.data('typecam');
            var numcont1 = button.data('numcont1');
            var typecont1 = button.data('typecont1');
            var numcont2 = button.data('numcont2');
            var typecont2 = button.data('typecont2');
            var numcont3 = button.data('numcont3');
            var typecont3 = button.data('typecont3');
              var numcont4 = button.data('numcont4');
            var typecont4 = button.data('typecont4');
              var numcont5 = button.data('numcont5');
            var typecont5 = button.data('typecont5');
            var client = button.data('client');
            var transitaire = button.data('transitaire');
            var representant = button.data('representant');

            // Assigner les valeurs aux éléments du modal
            var modal = $(this);
            modal.find('#id_mvt').val(id_mvt);  // Assignation de la valeur
            modal.find('#typecam').val(typecam);  // Assignation de la valeur
            modal.find('#numcont1').val(numcont1);  // Assignation de la valeur
            modal.find('#typecont1').val(typecont1);  // Assignation de la valeur
            modal.find('#numcont2').val(numcont2);
            modal.find('#typecont2').val(typecont2);
            modal.find('#numcont3').val(numcont3);
            modal.find('#typecont3').val(typecont3);
            modal.find('#numcont4').val(numcont4);
            modal.find('#typecont4').val(typecont4);
            modal.find('#numcont5').val(numcont5);
            modal.find('#typecont5').val(typecont5);
            modal.find('#client-select1').val(client);
            modal.find('#transitaire-select1').val(transitaire);
            modal.find('#representant-select1').val(representant);

            // Mettez à jour les labels pour afficher les conteneurs
            modal.find('#labelcont1').text(numcont1);
            modal.find('#labelcont2').text(numcont2);
            modal.find('#labelcont3').text(numcont3);
            modal.find('#labelcont4').text(numcont4);
            modal.find('#labelcont5').text(numcont5);
            var modal = $(this);

            // Conteneur 1
            // Conteneur 1
            // Vérifier si tous les conteneurs sont null
// Si les trois numéros de conteneurs sont nulles ou undefined, on cache tout
if ((!numcont1 || numcont1 === 'None') && (!numcont2 || numcont2 === 'None') && (!numcont3 || numcont3 === 'None') && (!numcont4 || numcont4 === 'None') && (!numcont5 || numcont5 === 'None')) {
modal.find('.checkbox-inline').hide(); // Cache tout le bloc si aucun conteneur n'a de valeur
$('#submitButton1').prop('disabled', true);
} else {
$('#submitButton1').prop('disabled', false);
// Conteneur 1
if (numcont1 && numcont1 !== 'None') {
    modal.find('#numcont1').val(numcont1).closest('.checkbox-inline').show();
} else {
    modal.find('#numcont1').closest('.checkbox-inline').hide();
}

// Conteneur 2
if (numcont2 && numcont2 !== 'None') {
    modal.find('#numcont2').val(numcont2).closest('.checkbox-inline').show();
} else {
    modal.find('#numcont2').closest('.checkbox-inline').hide();
}
// Conteneur 3
if (numcont3 && numcont3 !== 'None') {
    modal.find('#numcont3').val(numcont3).closest('.checkbox-inline').show();
} else {
    modal.find('#numcont3').closest('.checkbox-inline').hide();
}
// Conteneur 4
if (numcont4 && numcont4 !== 'None') {
    modal.find('#numcont4').val(numcont4).closest('.checkbox-inline').show();
} else {
    modal.find('#numcont4').closest('.checkbox-inline').hide();
}
// Conteneur 5
if (numcont5 && numcont5 !== 'None') {
    modal.find('#numcont5').val(numcont5).closest('.checkbox-inline').show();
} else {
    modal.find('#numcont5').closest('.checkbox-inline').hide();
}
}
        });
    });
</script>

<!-- FORMULAIRE MYMODAL 2 -->
<div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="editModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content" style="overflow-y: auto;">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Entrée Camion: ZUD</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form method="POST" action="{% url 'liaisonmouvement0' util.id_user %}" enctype="multipart/form-data">
                    {% csrf_token %}
                    {{ form.non_field_errors }}
                    <input type="hidden" id="id_mvt" name="id_mvt">
                    <input type="hidden" value="SEMI-REMORQUE" name="typecam">
                    <input type="hidden" name="client" id="client-select2">
                    <input type="hidden" name="representant" id="representant-select2">
                    <input type="hidden" name="transitaire" id="transitaire-select2">
                    <div class="form-group">
                        <label for="bd" class="form-label">Zone</label><br>
                        <div class="form-check form-check-inline">
                            <input value="Sud" type="radio" name="zone" checked required class="form-check-input">
                            <label for="bdOui" class="form-check-label">Sud</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input value="Nord" type="radio" name="zone" required class="form-check-input">
                            <label for="bdNon" class="form-check-label">Nord</label>
                        </div>
                    </div>
                    <input type="hidden" name="destination" value="zud">
                    <input type="hidden" name="entite" value="zud">

                    <div class="form-row">
                        <div class="col-md-3 mb-3">
                            <label for="camion-select2">Camion</label>
                            <select name="camion" class="form-control form-control-lg" id="camion-select2" required>
                                <option value="" data-type2="" data-transporteur2=""></option>
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="type2">Type</label>
                            <input type="text" name="type" id="type2" class="form-control form-control-lg"
                                   readonly/>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="transporteur2">Transporteur</label>
                            <input type="text" name="transporteur" id="transporteur2"
                                   class="form-control form-control-lg" readonly/>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info btn-block" data-toggle="modal"
                                    data-target="#myModalajoutcamion">
                                <i class="fas fa-plus-circle"></i>
                            </button>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col-md-4 mb-3">
                            <label for="chauffeur-select">Chauffeur</label>
                            <select name="chauffeur" class="form-control form-control-lg" id="chauffeur-select2"
                                    required>
                                <option value="" data-permis2=""></option>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="permis">Permis</label>
                            <input type="text" name="permis" id="permis2" class="form-control form-control-lg"
                                   readonly/>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-info btn-block" data-toggle="modal"
                                    data-target="#myModalajoutchauffeur">
                                <i class="fas fa-plus-circle"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Section conteneurs -->
                    <!--div class="row" id="conteneurs-div" style="display: none;">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="conteneur1">Conteneur 1</label>
                                <input type="text" class="form-control form-control-lg" name="numcont1"
                                       id="numconteneur2" placeholder="Entrez le conteneur"/>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="typeconteneur1">Type</label>
                                <select name="typeconteneur1" id="typeconteneur2"
                                        class="form-control form-control-lg">
                                    <option value="">Sélectionnez un type</option>
                                    <option value="20">20'</option>
                                    <option value="40">40'</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="row" id="conteneur2-div" style="display: none;">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="conteneur2">Conteneur 2</label>
                                <input type="text" class="form-control form-control-lg" name="numconteneur2"
                                       id="numconteneur2" placeholder="Entrez le conteneur">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="typeconteneur2">Type</label>
                                <select name="typeconteneur2" id="typeconteneur2"
                                        class="form-control form-control-lg">
                                    <option value="">Sélectionnez un type</option>
                                    <option value="20">20'</option>
                                    <option value="40">40'</option>
                                </select>
                            </div>
                        </div>
                    </div-->
                    <div class="form-row mb-4">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="remorque">Remorque</label>
                                <input id="remorque" type="text" name="remorque"
                                       class="form-control form-control-lg" placeholder="REMORQUE" required/>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="datetime-input">Date Validité</label>
                                <input type="datetime-local" name="date_validite" id="datetime-input"
                                       class="form-control form-control-lg" required/>
                            </div>
                        </div>
                    </div>
                    <div class="form-group ">
                        <label>Conteneurs:</label>
                        <div class="checkbox-inline">
                            <label>
                                <input type="checkbox" name="numcont1" id="numcont1" value="">
                                <span id="labelcont12"></span>
                            </label>
                        </div>
                        <div class="checkbox-inline">
                            <label>
                                <input type="checkbox" name="numcont2" id="numcont2" value="">
                                <span id="labelcont22"></span>
                            </label>
                        </div>
                        <div class="checkbox-inline">
                            <label>
                                <input type="checkbox" name="numcont3" id="numcont3" value="">
                                <span id="labelcont32"></span>
                            </label>
                        </div>
                    </div>

                    <!-- Champs cachés pour stocker les types de conteneurs -->
                    <input type="hidden" id="typecont12" name="typecont1">
                    <input type="hidden" id="typecont22" name="typecont2">
                    <input type="hidden" id="typecont32" name="typecont3">


                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                        <button type="submit" id="submitButton" class="btn btn-primary">Sauvegarder</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- SCRIPT QUI RENVOIE LES DONNES AU MYMODAL 2-->
<script>
    $(document).ready(function () {
        $('#myModal2').on('show.bs.modal', function (event) {
            var button = $(event.relatedTarget); // Bouton qui a déclenché le modal
            // Récupérer les valeurs des attributs `data-*`
            var id_mvt = button.data('id_mvt');
            var typecam = button.data('typecam');
            var numcont1 = button.data('numcont1');
            var typecont1 = button.data('typecont1');
            var numcont2 = button.data('numcont2');
            var typecont2 = button.data('typecont2');
            var numcont3 = button.data('numcont3');
            var typecont3 = button.data('typecont3');
            var client = button.data('client');
            var transitaire = button.data('transitaire');
            var representant = button.data('representant');
            // Assigner les valeurs aux éléments du modal
            var modal = $(this);
            modal.find('#id_mvt').val(id_mvt);  // Assignation de la valeur
            modal.find('#typecam').val(typecam);  // Assignation de la valeur
            modal.find('#numcont12').val(numcont1);  // Assignation de la valeur
            modal.find('#typecont12').val(typecont1);  // Assignation de la valeur
            modal.find('#numcont22').val(numcont2);
            modal.find('#typecont22').val(typecont2);
            modal.find('#numcont32').val(numcont3);
            modal.find('#typecont32').val(typecont3);
            modal.find('#client-select2').val(client);
            modal.find('#transitaire-select2').val(transitaire);
            modal.find('#representant-select2').val(representant);
            // Mettez à jour les labels pour afficher les conteneurs
            modal.find('#labelcont12').text(numcont1);
            modal.find('#labelcont22').text(numcont2);
            modal.find('#labelcont32').text(numcont3);
            var modal = $(this);
            // Conteneur 1
            // Conteneur 1
           // Conteneur 1
// Initialiser le bouton comme désactivé
//$('#submitButton').prop('disabled', true);

// Conteneur 1
if (numcont1 && numcont1.trim() !== "" && numcont1 !== "None") {
modal.find('#numcont1').val(numcont1).closest('.checkbox-inline').show();
} else {
modal.find('#numcont1').closest('.checkbox-inline').hide();
}

// Conteneur 2
if (numcont2 && numcont2.trim() !== "" && numcont2 !== "None") {
modal.find('#numcont2').val(numcont2).closest('.checkbox-inline').show();
} else {
modal.find('#numcont2').closest('.checkbox-inline').hide();
}

// Conteneur 3
if (numcont3 && numcont3.trim() !== "" && numcont3 !== "None") {
modal.find('#numcont3').val(numcont3).closest('.checkbox-inline').show();
} else {
modal.find('#numcont3').closest('.checkbox-inline').hide();
}

// Vérifier si au moins un conteneur a une valeur valide
if (
(numcont1 && numcont1.trim() !== "" && numcont1 !== "None") ||
(numcont2 && numcont2.trim() !== "" && numcont2 !== "None") ||
(numcont3 && numcont3.trim() !== "" && numcont3 !== "None")
) {
$('#submitButton').prop('disabled', false); // Activer le bouton
} else {
$('#submitButton').prop('disabled', true); // Désactiver le bouton
}

        });
    });
</script>

<!-- SweetAlert2 CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

<!-- SweetAlert2 JS -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const urlParams = new URLSearchParams(window.location.search);
        const success = urlParams.get('success');
        const error = urlParams.get('error');

        if (success === 'true') {
            Swal.fire({
                icon: 'success',
                title: 'Effectué',
                text: 'L\'ajout a été effectué avec succès.',
                showConfirmButton: false,  // Ne pas afficher le bouton OK
                timer: 3000  // Afficher le message pendant 3 secondes
            });
        } else if (error) {
            Swal.fire({
                icon: 'error',
                title: 'Erreur',
                text: error,
                confirmButtonText: 'OK'
            });
        }
    });
</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var typeConteneur1 = document.getElementById('typeconteneur1');
        var typeConteneur2 = document.getElementById('typeconteneur2');
        var conteneur2Div = document.getElementById('conteneur2-div');
        var conteneur3Div = document.getElementById('conteneur3-div');

        function toggleConteneurs() {
            console.log('Conteneur1 Value:', typeConteneur1.value);
            console.log('Conteneur2 Value:', typeConteneur2.value);

            // Afficher ou cacher conteneur2Div basé sur le type de conteneur1
            if (typeConteneur1.value.startsWith('20')) {
                conteneur2Div.style.display = 'block';
                if (typeConteneur2.value.startsWith('20')) {
                    conteneur3Div.style.display = 'block';
                } else {
                    conteneur3Div.style.display = 'none';
                }
            } else {
                conteneur2Div.style.display = 'none';
                conteneur3Div.style.display = 'none'; // Cacher aussi conteneur3Div si conteneur2 est caché
                return; // Sortir de la fonction si conteneur2 est caché
            }

            // Afficher ou cacher conteneur3Div basé sur le type de conteneur2

        }

        // Ajouter les gestionnaires d'événements pour les changements de type de conteneur
        typeConteneur1.addEventListener('change', function () {
            console.log('Conteneur1 changed');
            toggleConteneurs();
        });

        typeConteneur2.addEventListener('change', function () {
            console.log('Conteneur2 changed');
            toggleConteneurs();
        });

        // Initialiser l'état des conteneurs
        toggleConteneurs();
    });

    function actualiserListeCamions() {
        var select = $('#camion-select');
        var selectedValue = select.val();

        $.ajax({
            url: "{% url 'fetch_camion' %}", // Remplacez par l'URL de votre endpoint
            method: 'GET',
            success: function (data) {
                select.empty();
                select.append('<option value="" data-type="" data-transporteur="" data-immatriculation=""></option>');

                data.forEach(function (camion) {
                    select.append('<option value="' + camion.id_cam + '" data-type="' + camion.type + '" data-transporteur="' + camion.transporteur + '" data-immatriculation="' + camion.immatriculation + '">' + camion.immatriculation + '</option>');
                });

                select.val(selectedValue);
            },
            error: function (xhr, status, error) {
                console.error('Erreur lors de la récupération des camions:', error);
            }
        });
    }

    function actualiserListeCamions1() {
        var select = $('#camion-select1');
        var typecam = $(this).data('typecam');
        var selectedValue = select.val();

        $.ajax({
            url: "{% url 'fetch_camion' %}", // Assurez-vous que cette URL est correcte dans vos urls.py
            method: 'GET',
            success: function (data) {
                select.empty(); // Vide le menu déroulant
                select.append('<option value="" data-type1="" data-transporteur1="" data-immatriculation1=""></option>'); // Option vide

                // Boucle à travers les camions reçus
                data.forEach(function (camion) {
                    if (camion.type === 'SEMI-REMORQUE') {
                        select.append('<option value="' + camion.id_cam + '" data-type1="' + camion.type + '" data-transporteur1="' + camion.transporteur + '" data-immatriculation1="' + camion.immatriculation + '">' + camion.immatriculation + '</option>');
                    }
                });

                select.val(selectedValue); // Réapplique la sélection précédente, si existante
            },
            error: function (xhr, status, error) {
                console.error('Erreur lors de la récupération des camions:', error);
            }
        });
    }
    // Mise à jour des champs "type" et "transporteur" lorsque la sélection de camion change
    $('#camion-select1').on('change', function () {
        var selectedOption = $(this).find('option:selected');

        // Récupération des valeurs des attributs "data-" de l'option sélectionnée
        var type = selectedOption.data('type1');
        var transporteur = selectedOption.data('transporteur1');

        // Mise à jour des champs en fonction de la sélection
        $('#type1').val(type || '');
        $('#transporteur1').val(transporteur || '');
    });
function actualiserListeCamions2() {
        var select = $('#camion-select2');
        var selectedValue = select.val();
        $.ajax({
            url: "{% url 'fetch_camion' %}", // Assurez-vous que cette URL est correcte dans vos urls.py
            method: 'GET',
            success: function (data) {
                select.empty(); // Vide le menu déroulant
                select.append('<option value="" data-type2="" data-transporteur2="" data-immatriculation2=""></option>'); // Option vide

                // Boucle à travers les camions reçus
                data.forEach(function (camion) {
                    if (camion.type === 'VRAC') {
                        select.append('<option value="' + camion.id_cam + '" data-type2="' + camion.type + '" data-transporteur2="' + camion.transporteur + '" data-immatriculation2="' + camion.immatriculation + '">' + camion.immatriculation + '</option>');
                    }
                });
                select.val(selectedValue); // Réapplique la sélection précédente, si existante
            },
            error: function (xhr, status, error) {
                console.error('Erreur lors de la récupération des camions:', error);
            }
        });
    }
    // Mise à jour des champs "type" et "transporteur" lorsque la sélection de camion change
    $('#camion-select2').on('change', function () {
        var selectedOption = $(this).find('option:selected');

        // Récupération des valeurs des attributs "data-" de l'option sélectionnée
        var type = selectedOption.data('type2');
        var transporteur = selectedOption.data('transporteur2');

        // Mise à jour des champs en fonction de la sélection
        $('#type2').val(type || '');
        $('#transporteur2').val(transporteur || '');
    });

    function actualiserListeClients() {
        var select = $('#client-select');
        var selectedValue = select.val();

        $.ajax({
            url: "{% url 'fetch_client' %}",  // Remplacez par l'URL de votre endpoint
            method: 'GET',
            success: function (data) {
                select.empty();
                select.append('<option value="" data-telephone=""></option>');

                data.forEach(function (client) {
                    select.append('<option value="' + client.id_client + '" data-telephone="' + client.telephone + '">' + client.fullname + '</option>');
                });

                select.val(selectedValue);
            },
            error: function (xhr, status, error) {
                console.error('Erreur lors de la récupération des clients:', error);
            }
        });
    }

    $('#client-select').on('change', function () {
        var selectedOption = $(this).find('option:selected');
        var telephone = selectedOption.data('telephone');
        $('#telephone').val(telephone).attr('placeholder', telephone);
    });

    function actualiserListeCamionsVrac() {
        var select = $('#camionvrac-select');
        var selectedValue = select.val();

        $.ajax({
            url: "{% url 'fetch_camion' %}", // Remplacez par l'URL de votre endpoint
            method: 'GET',
            success: function (data) {
                select.empty();
                select.append('<option value="" data-type="" data-transporteurvrac=""></option>');

                data.forEach(function (camion) {
                    if (camion.type === 'VRAC') {
                        select.append('<option value="' + camion.id_cam + '" data-type="' + camion.type + '" data-transporteurvrac="' + camion.transporteur + '">' + camion.immatriculation + '</option>');
                    }
                });

                select.val(selectedValue);
                // Déclenche l'événement change pour mettre à jour le transporteur
                select.trigger('change');
            },
            error: function (xhr, status, error) {
                console.error('Erreur lors de la récupération des camions vrac:', error);
            }
        });
    }

    // Ajoutez ce code pour gérer le changement de sélection
    $('#camionvrac-select').on('change', function () {
        var selectedOption = $(this).find('option:selected');
        var transporteur = selectedOption.data('transporteurvrac');
        $('#transporteurvrac').val(transporteur).attr('placeholder', transporteur);
    });

    function actualiserListeChauffeurs() {
        var select = $('#chauffeur-select');
        var selectedValue = select.val();

        $.ajax({
            url: "{% url 'fetch_chauffeur' %}", // Remplacez par l'URL de votre endpoint
            method: 'GET',
            success: function (data) {
                select.empty();
                select.append('<option value="" data-permis=""></option>');

                data.forEach(function (chauffeur) {
                    select.append('<option value="' + chauffeur.id_chauffeur + '" data-permis="' + chauffeur.permis + '">' + chauffeur.fullname + '</option>');
                });

                select.val(selectedValue);
            },
            error: function (xhr, status, error) {
                console.error('Erreur lors de la récupération des chauffeurs:', error);
            }
        });
    }

    function actualiserListeChauffeurs1() {
        var select = $('#chauffeur-select1');
        var selectedValue = select.val();

        $.ajax({
            url: "{% url 'fetch_chauffeur' %}", // Remplacez par l'URL de votre endpoint
            method: 'GET',
            success: function (data) {
                select.empty();
                select.append('<option value="" data-permis1=""></option>');

                data.forEach(function (chauffeur) {
                    select.append('<option value="' + chauffeur.id_chauffeur + '" data-permis1="' + chauffeur.permis + '">' + chauffeur.fullname + '</option>');
                });

                select.val(selectedValue);
            },
            error: function (xhr, status, error) {
                console.error('Erreur lors de la récupération des chauffeurs:', error);
            }
        });
        select.on('change', function () {
            var selectedPermis = $(this).find('option:selected').data('permis1');
            $('#permis1').val(selectedPermis);
        });

    }
function actualiserListeChauffeurs2() {
        var select = $('#chauffeur-select2');
        var selectedValue = select.val();

        $.ajax({
            url: "{% url 'fetch_chauffeur' %}", // Remplacez par l'URL de votre endpoint
            method: 'GET',
            success: function (data) {
                select.empty();
                select.append('<option value="" data-permis2=""></option>');

                data.forEach(function (chauffeur) {
                    select.append('<option value="' + chauffeur.id_chauffeur + '" data-permis2="' + chauffeur.permis + '">' + chauffeur.fullname + '</option>');
                });

                select.val(selectedValue);
            },
            error: function (xhr, status, error) {
                console.error('Erreur lors de la récupération des chauffeurs:', error);
            }
        });
        select.on('change', function () {
            var selectedPermis = $(this).find('option:selected').data('permis2');
            $('#permis2').val(selectedPermis);
        });

    }
    function actualiserListeTransitaires() {
        var select = $('#transitaire-select');  // Updated to match the correct ID
        var selectedValue = select.val();
        $.ajax({
            url: "{% url 'fetch_transitaire' %}",
            method: 'GET',
            success: function (data) {
                console.log(data);
                select.empty();
                select.append('<option value="" data-fullname=""></option>');
                data.forEach(function (transitaire) {
                    select.append('<option value="' + transitaire.id_transit + '" data-teltransitaire="' + transitaire.telephone + '">' + transitaire.fullname + '</option>');
                });
                select.val(selectedValue);
            },
            error: function (xhr, status, error) {
                console.error('Erreur lors de la récupération des transitaires:', error);
            }
        });
    }

    function actualiserListeRepresentants() {
        var select = $('#transitairerep-select');  // Updated to match the correct ID
        var selectedValue = select.val();
        $.ajax({
            url: "{% url 'fetch_representant' %}",
            method: 'GET',
            success: function (data) {
                console.log(data);
                select.empty();
                select.append('<option value="" data-fullname=""></option>');
                data.forEach(function (transitaire) {
                    select.append('<option value="' + transitaire.id_transit + '" data-teltransitrep="' + transitaire.telephone + '">' + transitaire.fullname + '</option>');
                });
                select.val(selectedValue);
            },
            error: function (xhr, status, error) {
                console.error('Erreur lors de la récupération des transitaires:', error);
            }
        });
    }

    $(document).ready(function () {
        actualiserListeCamions();
        actualiserListeCamions1();
        actualiserListeCamions2();
        actualiserListeCamionsVrac();
        actualiserListeChauffeurs();
        actualiserListeChauffeurs1();
        actualiserListeChauffeurs2();
        actualiserListeTransitaires();
        actualiserListeClients();
        actualiserListeRepresentants();
        setInterval(actualiserListeClients, 5000);
        setInterval(actualiserListeRepresentants, 5000);
        setInterval(actualiserListeTransitaires, 5000);
        setInterval(actualiserListeCamions, 5000); // 20000 ms = 20 secondes
        setInterval(actualiserListeCamions1, 5000); // 20000 ms = 20 secondes
        setInterval(actualiserListeCamions2, 5000); // 20000 ms = 20 secondes
        setInterval(actualiserListeChauffeurs, 5000);
        setInterval(actualiserListeChauffeurs1, 5000);
        setInterval(actualiserListeChauffeurs2, 5000);
        setInterval(actualiserListeCamionsVrac, 5000); // 20000 ms = 20 secondes

        // Fonction pour filtrer les camions en fonction de la destination sélectionnée
        $('#destination-select').on('change', function () {
            var destination = $(this).val();
            var options = $('#camion-select option');
            var optionsVrac = $('#camionvrac-select option');

            // Réinitialisation des champs Camion, Type et Transporteur
            $('#camion-select').val('');
            $('#type').val('');
            $('#telephonetransit').val('');
            $('#transporteur').val('');
            $('#remorque').val('');

            options.each(function () {
                var option = $(this);
                var type = option.data('type');

                // Appeler la fonction toggleConteneurFields en fonction du type sélectionné
                toggleConteneurFields(type);
            });
        });function toggleConteneurFields(type) {
$('#conteneurs-div').hide();
$('#conteneurs-div .row').hide();

if (type === 'VRAC' || type === 'SEMI-REMORQUE') {
    $('#conteneurs-div').show();
    const maxSize = (type === 'SEMI-REMORQUE') ? 40 : 100;

    function updateConteneurDisplay() {
        let totalSize = 0;
        let conteneurCount = 0;

        $('select[name^="typeconteneur"]').each(function () {
            const size = parseInt($(this).val()) || 0;
            totalSize += size;
            if (size > 0) {
                conteneurCount++;
            }
        });
        if (totalSize > maxSize) {
            alert(`La taille totale des conteneurs ne doit pas dépasser ${maxSize}.`);
            return; // Stopper l'exécution si la limite est dépassée
        }
        for (let i = 1; i <= maxSize / 20; i++) {
            const conteneurDiv = $(`#conteneur${i}-div`);
            const conteneurTypeInput = $(`#typeconteneur${i}`);
            if (totalSize < maxSize && i <= conteneurCount + 1) {
                conteneurDiv.show();
                const remainingSpace = maxSize - totalSize;
                // Ajustement des options en fonction de l'espace restant
                if (remainingSpace <= 20) {
                    conteneurTypeInput.find('option[value="40"]').hide(); // Cache 40 si seulement 20 reste
                    conteneurTypeInput.val('20'); // Sélectionne automatiquement 20 si seule cette option est possible
                } else {
                    conteneurTypeInput.find('option[value="40"]').show();
                    conteneurTypeInput.find('option[value="20"]').show();
                }
            } else {
                conteneurDiv.hide();
            }
        }
    }
    updateConteneurDisplay();
    $('select[name^="typeconteneur"]').on('change', updateConteneurDisplay);
} else {
    // Masquer tous les champs de conteneur si le type est différent de VRAC ou SEMI-REMORQUE
    $('#conteneurs-div').hide();
    $('#conteneurs-div .row').hide();
}
}
        //function toggleConteneurFields(type) {
          //  if (type === 'SEMI-REMORQUE' ) {
            //    $('#conteneurs-div').show();
              //  $('#inputsforangards2').show();
                //$('#inputsforangards1').show();
            //} else  if (type === 'VRAC' ) {
              //  $('#conteneurs-div').show();
               // $('#inputsforangards2').show();
               // $('#inputsforangards1').show();
            //} else {
              //  $('#conteneurs-div').hide();
                //$('#inputsforangards2').hide();
                //$('#inputsforangards1').hide();
            //}
        //}
        // Fonction pour afficher ou masquer le deuxième conteneur en fonction du type du premier conteneur
        // Événement de changement pour le sélecteur de camion
        $('#camion-select').on('change', function () {
            var selectedOption = $(this).find('option:selected');
            var type = selectedOption.data('type');
            // Mise à jour des champs
            $('#type').val(type);
            $('#transporteur').val(selectedOption.data('transporteur'));
            $('#remorque').val(selectedOption.data('immatriculation'));
            // Afficher ou masquer les champs de conteneur
            toggleConteneurFields(type);
        });
        // Initialisation
        var initialType = $('#camion-select').find('option:selected').data('type');
        toggleConteneurFields(initialType);
        var initialTypeConteneur1 = $('#typeconteneur1').val();
        toggleConteneur2(initialTypeConteneur1);
        // Fonction pour afficher les détails du permis du chauffeur sélectionné
        $('#chauffeur-select').on('change', function () {
            var selectedOption = $(this).find('option:selected');
            var permis = selectedOption.data('permis');
            $('#permis').val(permis);
        });

        // Fonction pour afficher le téléphone du transitaire sélectionné
        $('#transitaire-select').on('change', function () {
            var selectedOption = $(this).find('option:selected');
            var transitaire = selectedOption.data('teltransitaire');
            $('#telephonetransit').attr('placeholder', transitaire); // Assurez-vous que l'ID est correct
        });
// Fonction pour afficher le téléphone du représentant sélectionné
        $('#transitairerep-select').on('change', function () {
            var selectedOption = $(this).find('option:selected');
            var transitaire = selectedOption.data('teltransitrep'); // Assurez-vous que la clé est correcte
            $('#telephonetransitrep').attr('placeholder', transitaire);
        });
        // Fonction pour mettre à jour les options du select de destination final
    });
</script>


</div>
</div>

</div>
</div>


</div>


<!-- Modal Bootstrap -->
<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Entrée Camion DEKALOG</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="editForm" method="post" action="/modifier_camion/">
                    {% csrf_token %}
                    <input type="hidden" id="boiteId" name="boite_id">
                    <div class="form-group">

                        <label for="immat">Immatriculation</label>
                        <input type="text" class="form-control" id="immat" name="immat" required>
                    </div>
                    <div class="form-group">
                        <label for="trans">Transporteur</label>
                        <input type="text" class="form-control" id="trans" name="trans" required>
                    </div>

                    <button type="submit" class="btn btn-primary">Enregistrer</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Inclure les scripts de Bootstrap et jQuery -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
<script>
    $('#editModal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget); // Bouton qui a déclenché le modal
        var id = button.data('id'); // Extraire les informations des attributs data-*
        var immatriculation = button.data('immatriculation');
        var transporteur = button.data('transporteur');

        var modal = $(this);
        modal.find('#boiteId').val(id);
        modal.find('#immat').val(immatriculation);
        modal.find('#trans').val(transporteur);
    });
</script>

</div>
</div>

<!-- Modal -->
<div class="modal fade" id="myModalajoutcamion" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="editModalLabel" aria-hidden="true">

    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Entrée Camion</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="form-ajout-camion" action="/ajouter_camion_dk_log/" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="id_user" value="{{ util.id_user }}">
                    <div class="form-group">
                        <label for="imat">Imatriculation</label><br>
                        <input type="text" id="immatriculation" name="immatriculation" required
                               class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="trans">Transporteur</label><br>
                        <input type="text" id="transporteur" name="transporteur" required class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="type">Type</label><br>
                        <select id="type" name="type" required class="form-control">
                            <option value=""></option>
                            <option value="SEMI-REMORQUE">SEMI-REMORQUE</option>
                            <option value="VRAC">VRAC</option>
                            <option value="TRANSPORT-VEHICULE">TRANSPORT-VEHICULE</option>
                            <option value="FRIGO">FRIGO</option>
                            <option value="PLATEAU">PLATEAU</option>
                            <option value="PORTE-CHAR">PORTE CHAR</option>
                            <option value="PORTE-VEHICULE">PORTE-VEHICULE</option>
                            <option value="PLATEAU">PLATEAU</option>

                        </select>
                    </div>


                </form>
            </div>
            <div class="modal-footer">
                <input type="button" id="submit-ajout-camion" class="btn btn-primary" value="Enregistrer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="myModalajoutcamionvrac" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="editModalLabel" aria-hidden="true">

    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Entrée Camion</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="form-ajout-camionvrac" action="/ajouter_camion_dk_log/" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="id_user" value="{{ util.id_user }}">
                    <div class="form-group">
                        <label for="imat">Imatriculation</label><br>
                        <input type="text" id="immatriculation" name="immatriculation" required
                               class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="trans">Transporteur</label><br>
                        <input type="text" id="transporteur" name="transporteur" required class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="type">Type</label><br>
                        <select id="type" name="type" required class="form-control">
                            <option value=""></option>
                            <option value="SEMI-REMORQUE">SEMI-REMORQUE</option>
                            <option value="VRAC">VRAC</option>
                            <option value="TRANSPORT-VEHICULE">TRANSPORT-VEHICULE</option>
                        </select>
                    </div>


                </form>
            </div>
            <div class="modal-footer">
                <input type="button" id="submit-ajout-camionvrac" class="btn btn-primary" value="Enregistrer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    $(document).ready(function () {
        $('#submit-ajout-camion').click(function () {
            $.ajax({
                url: $('#form-ajout-camion').attr('action'),
                type: 'POST',
                data: $('#form-ajout-camion').serialize(),
                success: function (response) {
                    if (response.success) {
                        Swal.fire({
                            icon: 'success',
                            title: 'Effectué',
                            text: 'Le camion a été ajouté avec succès!',
                            timer: 1500,  // Le message disparaît automatiquement après 1,5 seconde
                            showConfirmButton: false
                        }).then(() => {
                            $('#myModalajoutcamion').modal('hide');

                            // Vérifiez si un autre modal est ouvert
                            if ($('.modal.show').length) {
                                $('body').addClass('modal-open');
                            } else {
                                $('body').removeClass('modal-open');
                            }

                            // Forcer le retrait de tout overflow appliqué sur le body
                            $('body').css('overflow', '');
                        });
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Erreur',
                            text: 'Une erreur est survenue lors de l\'ajout du camion.',
                            confirmButtonText: 'OK'
                        });
                    }
                },
                error: function (xhr, status, error) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Erreur',
                        text: 'Erreur AJAX: ' + error,
                        confirmButtonText: 'OK'
                    });
                }
            });
        });
    });
</script>

<!--#####################Modale chauffeur########################--->
<!--you-->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


<!--#####################Transiatirer########################--->

<div class="modal fade" id="myModalajouttransitaire" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="editModalLabel" aria-hidden="true">

    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Ajouter Transitaire</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="form-ajout-transitaire" action="/ajouter_transitaire/" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="id_user" value="{{ util.id_user }}">
                    <input type="hidden" name="mission" value="transitaire">
                    <div class="form-group">
                        <label for="fullname">Prenom & Nom</label><br>
                        <input type="text" id="fullname" name="fullname" required class="form-control">
                    </div>

                    <div class="form-group">
                        <label for="telephone">Telephone</label><br>
                        <input type="tel" id="telephone" name="telephone" required class="form-control">
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <input type="button" id="submit-ajout-transitaire" class="btn btn-primary" value="Enregistrer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Fermer</button>
            </div>
        </div>

    </div>
</div>

<!-- pour chauffeur -->
<div class="modal fade" id="myModalajoutchauffeur" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="editModalLabel" aria-hidden="true">

    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Ajout Chauffeur</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="form-ajout-chauffeur" action="/ajouter_chauffeur/" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="id_user" value="{{ util.id_user }}">
                    <div class="form-group">
                        <label for="fullname">Prenom & Nom</label><br>
                        <input type="text" id="fullnamechauffeur" name="fullname" required class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="fullname">Permis</label><br>
                        <input type="text" id="permischauffeur" name="permis" required class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="fullname">Date D'expiration</label><br>
                        <input type="date" id="datepermischauffeur" name="date_exp_permis" required
                               class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="telephone">Telephone</label><br>
                        <input type="tel" id="telephonechauffeur" name="telephone" required class="form-control">
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <input type="button" id="submit-ajout-chauffeur" class="btn btn-primary" value="Enregistrer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Fermer</button>
            </div>
        </div>

    </div>
</div>

<div class="modal fade" id="myModalajouttransitairerep" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="editModalLabel" aria-hidden="true">

    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Ajouter Représentant</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="form-ajout-transitairerep" action="/ajouter_transitaire/" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="id_user" value="{{ util.id_user }}">
                    <input type="hidden" name="mission" value="representant">
                    <div class="form-group">
                        <label for="fullname">Prenom & Nom</label><br>
                        <input type="text" id="fullname" name="fullname" required class="form-control">
                    </div>

                    <div class="form-group">
                        <label for="telephone">Telephone</label><br>
                        <input type="tel" id="telephone" name="telephone" required class="form-control">
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <input type="button" id="submit-ajout-transitairerep" class="btn btn-primary" value="Enregistrer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Fermer</button>
            </div>
        </div>

    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Inclure SweetAlert CDN -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    $(document).ready(function () {
        $('#submit-ajout-transitaire').click(function () {
            $.ajax({
                url: $('#form-ajout-transitaire').attr('action'),
                type: 'POST',
                data: $('#form-ajout-transitaire').serialize(),
                success: function (response) {
                    if (response.success) {
                        // Afficher SweetAlert de succès
                        Swal.fire({
                            icon: 'success',
                            title: 'Succès',
                            text: 'Le transitaire a été ajouté avec succès !',
                            showConfirmButton: false,
                            timer: 1500 // La fenêtre d'alerte se ferme automatiquement après 1.5 seconde
                        }).then(() => {
                            // Fermer le modal après la réussite
                            $('#myModalajouttransitaire').modal('hide');
                            // Optionnel : actualiser les options du select si nécessaire
                        });
                    } else {
                        // Afficher SweetAlert d'erreur
                        Swal.fire({
                            icon: 'error',
                            title: 'Erreur',
                            text: 'Une erreur est survenue lors de l\'ajout du transitaire.',
                        });
                    }
                },
                error: function (xhr, status, error) {
                    // Afficher SweetAlert d'erreur pour les erreurs AJAX
                    Swal.fire({
                        icon: 'error',
                        title: 'Erreur AJAX',
                        text: 'Une erreur est survenue lors de la requête AJAX : ' + error,
                    });
                }
            });
        });
    });
</script>

<!-- script pour chauffeur -->
<script>
    $(document).ready(function () {
        $('#submit-ajout-chauffeur').click(function () {
            $.ajax({
                url: $('#form-ajout-chauffeur').attr('action'),
                type: 'POST',
                data: $('#form-ajout-chauffeur').serialize(),
                success: function (response) {
                    if (response.success) {
                        Swal.fire({
                            icon: 'success',
                            title: 'Effectué',
                            text: 'Le chauffeur a été ajouté avec succès!',
                            timer: 1500,  // Le message disparaît automatiquement après 1,5 seconde
                            showConfirmButton: false
                        }).then(() => {
                            $('#myModalajoutchauffeur').modal('hide');
                        });
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Erreur',
                            text: 'Une erreur est survenue lors de l\'ajout du chauffeur.',
                            confirmButtonText: 'OK'
                        });
                    }
                },
                error: function (xhr, status, error) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Erreur',
                        text: 'Erreur AJAX: ' + error,
                        confirmButtonText: 'OK'
                    });
                }
            });
        });
    });
</script>

<script>
    $(document).ready(function () {
        $('#submit-ajout-transitairerep').click(function () {
            $.ajax({
                url: $('#form-ajout-transitairerep').attr('action'),
                type: 'POST',
                data: $('#form-ajout-transitairerep').serialize(),
                success: function (response) {
                    if (response.success) {
                        // Afficher SweetAlert de succès
                        Swal.fire({
                            icon: 'success',
                            title: 'Succès',
                            text: 'Le transitaire a été ajouté avec succès !',
                            showConfirmButton: false,
                            timer: 1500 // La fenêtre d'alerte se ferme automatiquement après 1.5 seconde
                        }).then(() => {
                            // Fermer le modal après la réussite
                            $('#myModalajouttransitairerep').modal('hide');
                            // Optionnel : actualiser les options du select si nécessaire
                        });
                    } else {
                        // Afficher SweetAlert d'erreur
                        Swal.fire({
                            icon: 'error',
                            title: 'Erreur',
                            text: 'Une erreur est survenue lors de l\'ajout du transitaire.',
                        });
                    }
                },
                error: function (xhr, status, error) {
                    // Afficher SweetAlert d'erreur pour les erreurs AJAX
                    Swal.fire({
                        icon: 'error',
                        title: 'Erreur AJAX',
                        text: 'Une erreur est survenue lors de la requête AJAX : ' + error,
                    });
                }
            });
        });
    });
</script>
<!----CHuaffeur ----->


<div class="modal fade" id="myModalajoutclient" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="editModalLabel" aria-hidden="true">

    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Ajout Client</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="form-ajout-client" action="/ajouter_client/" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="id_user" value="{{ util.id_user }}">
                    <div class="form-group">
                        <label for="fullname">Prenom & Nom</label><br>
                        <input type="text" id="fullnamechauffeur" name="fullname" required class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="telephone">Telephone</label><br>
                        <input type="tel" id="telephoneclient" name="telephone" required class="form-control">
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <input type="button" id="submit-ajout-client" class="btn btn-primary" value="Enregistrer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Fermer</button>
            </div>
        </div>

    </div>
</div>


<script>
    $(document).ready(function () {
        $('#submit-ajout-client').click(function () {
            $.ajax({
                url: $('#form-ajout-client').attr('action'),
                type: 'POST',
                data: $('#form-ajout-client').serialize(),
                success: function (response) {
                    if (response.success) {
                        Swal.fire({
                            icon: 'success',
                            title: 'Effectué',
                            text: 'Le chauffeur a été ajouté avec succès!',
                            timer: 1500,  // Le message disparaît automatiquement après 1,5 seconde
                            showConfirmButton: false
                        }).then(() => {
                            $('#myModalajoutclient').modal('hide');
                        });
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Erreur',
                            text: 'Une erreur est survenue lors de l\'ajout du chauffeur.',
                            confirmButtonText: 'OK'
                        });
                    }
                },
                error: function (xhr, status, error) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Erreur',
                        text: 'Erreur AJAX: ' + error,
                        confirmButtonText: 'OK'
                    });
                }
            });
        });
    });
</script>


{% endblock content %}